<div class="notes-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>
        <mat-icon>note</mat-icon>
        Notes Management
      </mat-card-title>
      <mat-card-subtitle>Create, read, update, and delete your notes</mat-card-subtitle>
    </mat-card-header>
    
    <mat-card-content>
      <div class="actions-row">
        <button mat-raised-button color="primary" (click)="openNoteDialog()">
          <mat-icon>add</mat-icon>
          Add New Note
        </button>
        <button mat-button (click)="loadNotes()" [disabled]="loading">
          <mat-icon>refresh</mat-icon>
          Refresh
        </button>
      </div>

      <!-- Search Bar -->
      <app-search-bar (searchChange)="onSearchChange($event)"></app-search-bar>

      <!-- Advanced Search -->
      <app-advanced-search (filtersChange)="onAdvancedFiltersChange($event)"></app-advanced-search>

      <div class="notes-content">
        <mat-progress-bar *ngIf="loading" mode="indeterminate"></mat-progress-bar>
        
        <!-- Search Results Info -->
        <div *ngIf="searchQuery && !loading" class="search-info">
          <mat-icon>search</mat-icon>
          <span>Search results for "{{ searchQuery }}" ({{ filteredNotes.length }} notes found)</span>
        </div>
        
        <div *ngIf="!loading && filteredNotes.length === 0 && notes.length > 0" class="no-search-results">
          <mat-icon>search_off</mat-icon>
          <p>No notes found matching "{{ searchQuery }}"</p>
          <button mat-button (click)="onSearchChange('')">Clear search</button>
        </div>
        
        <div *ngIf="!loading && filteredNotes.length === 0 && notes.length === 0" class="no-notes">
          <mat-icon>inbox</mat-icon>
          <p>No notes found. Create your first note!</p>
        </div>

        <div *ngIf="!loading && filteredNotes.length > 0" class="notes-grid">
          <mat-card *ngFor="let note of filteredNotes" class="note-card">
            <mat-card-header>
              <mat-card-title>{{ note.title }}</mat-card-title>
              <mat-card-subtitle>
                Created: {{ formatDate(note.createdAt) }}
              </mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <p *ngIf="note.content" class="note-content">
                {{ note.content.length > 100 ? (note.content | slice:0:100) + '...' : note.content }}
              </p>
              <p *ngIf="!note.content" class="no-content">
                <em>No content</em>
              </p>
            </mat-card-content>
            
            <mat-card-actions>
              <button mat-button color="primary" (click)="openNoteDialog(note)">
                <mat-icon>edit</mat-icon>
                Edit
              </button>
              <button mat-button color="warn" (click)="deleteNote(note.id!)">
                <mat-icon>delete</mat-icon>
                Delete
              </button>
            </mat-card-actions>
          </mat-card>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
</div>
